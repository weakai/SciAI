---

---

http://www.scbdd.com/chemdes/

http://www.scbdd.com/chemdes/list-fingerprints/

## Morgan Fingerprints

[RDKit|摩根分子指纹计算、提取与可视化](https://www.jianshu.com/p/215defebb77d)

圆形指纹，也属于拓扑型指纹

通过对标准的摩根算法进行改造后得到

可以大致等同于扩展连通性指纹（Extended-Connectivity Fingerprints，ECFPs）

优点

- 计算速度快、没有经过预定义（可以表示无穷多种不同的分子特征）、可以包含手性信息、指纹中的每个元素代表一种特定子结构、可以方便地进行分析和解释、可以根据不同的需要进行相应的修改等。

- 这类指纹设计的最初目的是用于搜索与活性相关的分子特征，而非子结构搜索。此外也可以用于相似性搜索、聚类、虚拟筛选等方向。指纹的生成过程大致分为以下几个步骤：

  1. 原子初始化，为每个重原子分配一个整数标识符

  2. 迭代更新，以每个重原子为中心，将周围一圈的重原子合并进来，直到到达指定半径
  3. 特征生成，对子结构进行运算，并生成特征列表

  
## 扩展连通性指纹

Extended Connectivity Fingerprints，ECFPs

圆形拓扑指纹，可用于分子表示、相似性搜索、构效关系建模。它在药物设计中有诸多应用，是最受欢迎的相似性比对工具。

应用：

- 搜索工具
- 最早应用在高通量筛选，用于分析 HTS 中假阳性和假阴性先导物
- 此外，ECFPs 也经常应用在基于配体的虚拟筛选中，用来判断化合物是否有活性
- 特定的子结构搜索

特点：

- 圆形原子邻域（circular atom neighborhoods）来表示分子结构
- fast
- 这些特征代表特定子结构的存在与否
- 没有经过预定义，可以表示大量不同的分子特性（包括立体化学信息）
- 它用来表示功能基团（functionality）的是否存在，对于分析分子活性至关重要
- 它的生成算法非常灵活，可以针对不同的场景，生成不同的指纹

表示方法：

- 整数标识列（list of integer identifiers）
  - ECFPs 可以通过一组不定长的整数标识符来表示，这是最原始和最精确的表示方法。每个标识符代表了一个特定的子结构，更准确地说是分子里的一种圆形原子邻域。这种整数标识符是按升序排列。
  - 这些标识符也可以被理解为是一个超大的虚拟比特串的索引。比特串中的每个位置表示一个特定子结构的特征。因为这个虚拟的比特串非常庞大且稀疏，所以它并没有被显式地存储，而是用代表比特串的索引来组成这个不定长的整数列表。由于技术原因，这种特征标识符存储为一种有符号的数值，因此是可正可负的。
  - 默认情况下，在一个整数标识列中，每种标识符最多仅含一个（rdkit默认不会去重）。然而，在一些特定的场景下，也需要考虑某种标识符在分子中出现的频数，这种ECFPs的变体叫做ECFC。在ChemAxon的工具中，有一个参数控制是否统计频数，默认模式为不统计，统计时称为ECFC模式。

- 定长比特串（fixed-length bit string）
  - 传统的二进制分子表示方法是通过固定长度的比特串实现的。而ECFPs也可以通过“折叠”操作来形成定长比特串，也就是将底层的整数标识列压缩成一个更短长度的定长比特串（就是一个向量，常见的长度有1024,2048等）。
  - 与上面的整数标识列表相比，ECFPs的定长比特串简化了比对和相似性计算，也相应减少了存储开销，尤其是大分子。另一方面，压缩的操作可能会引入冲突，因为压缩后，多个不同的子结构特征可能会用同一个比特位表示。这种情况下，会丢失一些分子信息，造成特征质量和可解释性的下降。
  - 需要注意的是，由标识列可以得到定长比特串，但没法从定长比特串得到标识列。定长比特串可以看作是标识列的有损压缩。

生成流程

1. 初始化原子标识符
   1. ECFP生成时，首先对给定分子的每一个非氢原子分配一个初始整数标识符。该标识符是通过把原子的属性（例如原子序号、连接数量等）打包，再经哈希函数转变成一个整数变量而得到，包含了相应原子的化学信息。
   2. 需要考虑的原子属性是ECFPs中一个重要的参数，可以完全由自己设置。
2. 标识符的迭代更新
   1. 初始化后，会进行一系列迭代操作，将某一原子的初始标识符与邻近原子的标识符合并，直到到达设置的半径为止。每一轮迭代都会捕捉距中心原子越来越远的原子信息，最终经哈希运算，编码成为一个整数值，这些整数值合并形成一个整数标识列。
   2. 这种迭代更新的过程基于一种摩根算法（Morgan algorithm）
3. 标识符去重
   1. 最终生成指纹的过程中，会去除等价的原子标识符。等价意味着他们包含一组相同的键，或他们有相同的哈希值。在这步操作中，如果标识符的频数需要保留（ECFC模式），相同标识符出现的次数将会被保存。

## 基于路径的指纹

path-based fingerprints 广泛用于子结构搜索中预过滤（pre-filtering）。与这种指纹相反，ECFPs 并不适合子结构搜索，而适合快速高效地筛选整个分子和进行相似性搜索。ECFPs 可以为相似性搜索提供充分的结果，更接近药物化学家的需求。

## 参考

[扩展连通性指纹（Extended Connectivity Fingerprints，ECFPs）原理介绍](https://blog.csdn.net/dreadlesss/article/details/105590719)

