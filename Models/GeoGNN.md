---
title: GeoGNN

---

#### 背景

- 百度团队
- Nature Machine Intelligence
- 分子几何信息表征结合自监督学习，有效改善分子性质预测

#### 策略与范式

- 自监督学习与微调
- 标签数据稀疏的问题阻碍了图神经网络在分子性质预测中的应用
  - 标签数据稀疏: 某一标签占比太大

#### 方法

![](https://mmbiz.qpic.cn/sz_mmbiz_png/IBYsyRibb4EfCOPxuNSyQFhtINhIvItXgoa4ucAwMQZsX2Pn7ewtKEMhmiaHfxOEVIhibTicvU1xLibxOC7PYiaicZTgw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

整个 GEM 模型框架包含两个部分，一是**基于几何信息的消息传递图神经网络(GeoGNN)**（如**图1**所示），二是若干**在几何水平上的自监督学习任务**。

首先，作者在常见的以原子为节点、化学键为边的分子图 G 基础上，通过设计以化学键为节点、键角为边的分子图 H 来反映分子的三维立体结构。

原子-键图 G 与键-键角图 H 之间通过表征键的向量进行消息传递，在 GNN 的消息传递与反复迭代过程中不断更新。每一次的迭代均按照如下的顺序进行：在输入表征键与键角的向量构建图 H 后，第一步通过整合相邻的键与相应键角所传递的消息对键的表征向量进行学习。在将其传递到图 G 后，第二步网络会对更新的图G整合来自相邻的键与原子所传递的消息，学习表征原子的节点向量完成对图 G 的更新。最后一次迭代结束时，GNN 通过整合图G中对原子的向量表征来获得表征整个分子的向量。

#### 任务

![](https://mmbiz.qpic.cn/sz_mmbiz_png/IBYsyRibb4EfCOPxuNSyQFhtINhIvItXgyJy0meRoJ4TIibm6FbiaYia1vwxoKBukwY4M7cyDNL7qtMn9pVZBTS2kA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)

自监督学习任务设计的示意，从左至右分别为键长预测、键角预测和原子距离矩阵元素的预测。

另一方面，作者设计了几项几何水平上的自监督学习任务，包括了键长、键角的预测与原子距离矩阵的预测（如**图2**所示）。其中，键长、键角是最重要的分子几何参数，前者反映了化学键的强弱，两者结合共同反映了分子局部的空间结构，相应的预测属于节点级别的任务。至于分子整体水平的立体结构，则通过原子距离矩阵进行描述，其预测是一项图级别的任务。

键长、键角预测这两项自监督学习任务的设置方法是类似的。对于某个分子，先随机选择出 15% 的原子，并对每个选中的原子，均遮挡其相邻的原子与键，以及这些键所形成的键角。在 GeoGNN 最后一次迭代时，利用不断更新最终获得的原子与键的表征向量来预测被遮挡的值。为了计算及惩罚模型预测的误差，作者设计了一个回归的损失函数。

在原子距离矩阵预测的任务设计上，作者利用原子的三维坐标计算出每个分子的距离矩阵，最后的任务则是预测矩阵中被随机遮挡的元素。与键长、键角预测不同的是，由于具有相同拓扑结构的两个分子，对应原子间的距离可能存在明显的差异（如**图3**），因此在设计损失函数时，将其处理成多分类的问题，把原子距离等间隔地投影在 30 个区间中。

在 GEM 的模型架构基础上，作者以 ZINC15 数据库中采样得到的 2 千万个无标记分子作为所使用的数据集，从中随机选取 90% 对其进行预训练。随后，GeoGNN 将在 MoleculeNet 中15个标准测试集上同现有的多个模型进行比较，这些测试集既包含分类任务也包含回归任务，并分别以 ROC-AUC 的均值与 RMSE/MAE 作为两大类任务的评价指标。针对这些不同的测试集，通过**分子骨架裂分(scaffold split)的方式对各自的数据集进行划分**，用所得到的训练集对模型进一步训练。最终，在其中 14 个测试集上取得了当前最佳的表现（如**表1**所示）。

![](https://mmbiz.qpic.cn/sz_mmbiz_png/IBYsyRibb4EfCOPxuNSyQFhtINhIvItXgkOZKia8qoupRZic6ECJq2N0JmJvEiaxlABfqiahYDlyOcWWAIBCI4wVYow/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1)



#### 挑战

- 现有采用自监督学习的图神经网络模型普遍只考虑了分子的拓扑结构，而无法反映分子的三维空间结构，但后者对于分子性质的影响又是显而易见的。

#### 结果

- 该模型在 15 个性质预测标准测试集上进行了评估，同现有模型的基线相比，在其中的 14 个测试集上都取得了目前最优的表现。

